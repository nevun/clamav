--- clamav-0.100.0/clamav-milter/clamav-milter.c	2018-04-04 02:13:58.000000000 +0200
+++ clamav-0.100.0/clamav-milter/clamav-milter.c.umask	2018-05-28 23:25:12.374047156 +0200
@@ -432,7 +432,7 @@
 
     if((opt = optget(opts, "PidFile"))->enabled) {
 	FILE *fd;
-	mode_t old_umask = umask(0002);
+	mode_t old_umask = umask(0022);
 
 	if((fd = fopen(opt->strarg, "w")) == NULL) {
 	    logg("!Can't save PID in file %s\n", opt->strarg);
--- clamav-0.100.0/shared/output.c			2018-04-04 02:13:58.000000000 +0200
+++ clamav-0.100.0/shared/output.c.umask		2018-05-28 23:24:41.968851516 +0200
@@ -379,7 +379,7 @@
 
     if (!logg_fp && logg_file)
     {
-        old_umask = umask(0037);
+        old_umask = umask(0077);
         if ((logg_fp = fopen(logg_file, "at")) == NULL)
         {
             umask(old_umask);
--- clamav-0.100.0/freshclam/freshclam.c		2018-04-04 02:13:58.000000000 +0200
+++ clamav-0.100.0/freshclam/freshclam.c.umask		2018-05-28 23:25:30.675164850 +0200
@@ -127,7 +127,7 @@
 {
     FILE *fd;
     int old_umask;
-    old_umask = umask (0006);
+    old_umask = umask (0022);
     if ((fd = fopen (pidfile, "w")) == NULL)
     {
         logg ("!Can't save PID to file %s: %s\n", pidfile, strerror (errno));
